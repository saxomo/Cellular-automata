<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="content-type" />
<title>Cellular Automata</title>
<meta http-equiv="Content-Script-Type" content="text/javascript" /> 
<script type="text/javascript">
var paterns= new Array(new Array(1,1,1),
  						new Array(1,1,0),
							new Array(1,0,1),
							new Array(1,0,0),
							new Array(0,1,1),
							new Array(0,1,0),
							new Array(0,0,1),
							new Array(0,0,0));
function canvas(){ 
	document.write('<button onclick="cellular(1)">+</button> <button onclick="cellular(-1)">-</button> ');
	document.write( '<button onclick="cellular(2)">Rand()</button>' )  ;
	document.write('<form name="oForm" onclick="cellular(0)">');
	document.write('<select id="target">');
	for(var i = 0;i < 256 ; i++)
		document.write('<option  value='+i+' '+( i == 30 ?  'selected' : '' )+'>'+i+'</option>');
	document.write('</select>');
	document.write('<input type="radio" value=1 name="pxl" />1px');
	document.write('<input type="radio" value=2 name="pxl" checked />2px');
	document.write('<input type="radio" value=3 name="pxl" />3px');
	document.write(' </form>');
	
	document.write('<canvas id="example" width="600" height="320">');
	document.write( 'This text is displayed if your browser does not support HTML5 Canvas.');
	document.write( '</canvas>');
	}
function cellular(x){
 	cellularAutomata(30,30,x) ;
}
function getCheckedValue(radioObj) {
	if(!radioObj)
		return "";
	var radioLength = radioObj.length;
	if(radioLength == undefined)
		if(radioObj.checked)
			return radioObj.value;
		else
			return "";
	for(var i = 0; i < radioLength; i++) {
		if(radioObj[i].checked) {
			return radioObj[i].value;
		}
	}
	return "";
}
 
function toEightPlaces(x){
	while(x.length<8)x = "0"+x;
	return x;
}
function cellularAutomata(y,x,nn) { 
 
 	var nPx = getCheckedValue(document.forms["oForm"].elements["pxl"]) ;	 
    var p = 0 ,
	white = new Array(),  
	example = document.getElementById('example'), 
	context = example.getContext('2d');
	var n = 516/nPx, 
	c = (n/2)-1,
	f =  parseInt(document.getElementById("target").value).toString(2), 
	cel= toEightPlaces(f) ;
	
	document.getElementById("target").value=nn==2?Math.floor(Math.random()*255):parseInt(document.getElementById("target").value)+nn;
		
	for(var i = 0 ; i < n ; i++){
		white[i] = new Array(); 
    	for(var j = 0 ; j < n ; j++){
    		white[i][j]=i==c?1:0;
    	}
    }  
    context.fillStyle =  "rgb(255, 255, 255)" ;
    context.fillRect(x ,y , 630, 380);  
	context.fillStyle =  "rgb(55 ,55 ,55)";
    var tmp;
    for( i = 0; i < c ; i++){ 		
    	for( j = c-i ; j < (c + i + 1) ; j++){  
    		white[j][i+1] =  cel.charAt(whichPatern(white[j-1][i],white[j][i],white[j+1][i]));
    		white[j][i+1]!="1"? context.fillRect(x+nPx*j , y+nPx*i , nPx , nPx ) : context ; 	
    	}
    } 
} 
		
function whichPatern( b, c, d  ) {
	
	var s=0; 
	while( !((b==paterns[s][0])&&(c==paterns[s][1])&&(d==paterns[s][2])))s++;  
	return s;
}

function intToTrinaty( x) {
	 
    var t="";
	 
	while(x!=0 ){
		t = ""+ x%3 + t;
		x=(x - x%3)/3 ;
	} 
	return t;
} 
</script>
</head>
	<body>
		<script type="text/javascript">
			canvas();
		</script>
	</body>
</html>